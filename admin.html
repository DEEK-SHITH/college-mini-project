<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Smart Timetable</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="top">
    <h1>‚öôÔ∏è Admin Dashboard</h1>
    <p>Manage timetables, courses, teachers, and system configuration</p>
    <div class="user-info">
      <span id="adminName">Loading...</span>
      <button onclick="logout()" class="logout-btn">Logout</button>
    </div>
  </div>

  <div class="container admin-container">
    <!-- Admin Sidebar -->
    <div class="admin-sidebar">
      <div class="sidebar-header">
        <h3>Navigation</h3>
      </div>
      <div class="sidebar-menu">
        <button class="menu-item active" onclick="showSection('dashboard')">
          üìä Dashboard
        </button>
        <button class="menu-item" onclick="showSection('timetable-gen')">
          üéØ Timetable Generation
        </button>
        <button class="menu-item" onclick="showSection('course-mgmt')">
          üìö Course Management
        </button>
        <button class="menu-item" onclick="showSection('faculty-mgmt')">
          üë®‚Äçüè´ Faculty Management
        </button>
        <button class="menu-item" onclick="showSection('room-mgmt')">
          üè´ Room Management
        </button>
        <button class="menu-item" onclick="showSection('reports')">
          üìà Reports & Analytics
        </button>
        <button class="menu-item" onclick="showSection('settings')">
          ‚öôÔ∏è System Settings
        </button>
      </div>
      
      <!-- Quick Stats -->
      <div class="sidebar-stats">
        <div class="stat-item">
          <span class="stat-number" id="totalCourses">0</span>
          <span class="stat-label">Courses</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="totalFaculty">0</span>
          <span class="stat-label">Faculty</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="totalRooms">0</span>
          <span class="stat-label">Rooms</span>
        </div>
      </div>
    </div>

    <!-- Admin Content -->
    <div class="admin-content">
      <!-- Dashboard Section -->
      <div id="dashboard" class="content-section active">
        <div class="section-header">
          <h2>üìä Admin Dashboard</h2>
          <p>Welcome back! Here's your system overview</p>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
          <div class="stat-card primary">
            <div class="stat-icon">üìö</div>
            <div class="stat-content">
              <span class="stat-number" id="dashboardCourses">0</span>
              <span class="stat-label">Total Courses</span>
            </div>
          </div>
          <div class="stat-card success">
            <div class="stat-icon">üë®‚Äçüè´</div>
            <div class="stat-content">
              <span class="stat-number" id="dashboardFaculty">0</span>
              <span class="stat-label">Faculty Members</span>
            </div>
          </div>
          <div class="stat-card warning">
            <div class="stat-icon">üè´</div>
            <div class="stat-content">
              <span class="stat-number" id="dashboardRooms">0</span>
              <span class="stat-label">Rooms</span>
            </div>
          </div>
          <div class="stat-card info">
            <div class="stat-icon">üéØ</div>
            <div class="stat-content">
              <span class="stat-number" id="dashboardTimetables">0</span>
              <span class="stat-label">Active Timetables</span>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions-panel">
          <h3>üöÄ Quick Actions</h3>
          <div class="action-grid">
            <button class="action-card" onclick="showSection('timetable-gen')">
              <div class="action-icon">üéØ</div>
              <div class="action-text">
                <h4>Generate Timetable</h4>
                <p>Create new timetable automatically</p>
              </div>
            </button>
            <button class="action-card" onclick="showAddCourseModal()">
              <div class="action-icon">üìö</div>
              <div class="action-text">
                <h4>Add Course</h4>
                <p>Create new course</p>
              </div>
            </button>
            <button class="action-card" onclick="showAddFacultyModal()">
              <div class="action-icon">üë®‚Äçüè´</div>
              <div class="action-text">
                <h4>Add Faculty</h4>
                <p>Register new faculty member</p>
              </div>
            </button>
            <button class="action-card" onclick="showAddRoomModal()">
              <div class="action-icon">üè´</div>
              <div class="action-text">
                <h4>Add Room</h4>
                <p>Register new classroom/lab</p>
              </div>
            </button>
          </div>
        </div>

        <!-- Recent Activity -->
        <div class="recent-activity">
          <h3>üìã Recent Activity</h3>
          <div class="activity-list" id="recentActivityList">
            <!-- Activity items will be loaded here -->
          </div>
        </div>
      </div>

      <!-- Timetable Generation Section -->
      <div id="timetable-gen" class="content-section">
        <div class="section-header">
          <h2>üéØ Smart Timetable Generation</h2>
          <p>Automatically generate conflict-free timetables based on constraints</p>
        </div>

        <div class="generation-wizard">
          <!-- Step 1: Configuration -->
          <div class="wizard-step active" id="step1">
            <h3>1. Configuration</h3>
            <div class="config-grid">
              <div class="config-group">
                <label for="academicYear">Academic Year *</label>
                <input type="text" id="academicYear" placeholder="e.g., 2024-25" required>
              </div>
              <div class="config-group">
                <label for="semesterSelect">Semester *</label>
                <select id="semesterSelect" required>
                  <option value="">Select Semester</option>
                  <option value="1">Semester 1</option>
                  <option value="2">Semester 2</option>
                  <option value="3">Semester 3</option>
                  <option value="4">Semester 4</option>
                  <option value="5">Semester 5</option>
                  <option value="6">Semester 6</option>
                  <option value="7">Semester 7</option>
                  <option value="8">Semester 8</option>
                </select>
              </div>
              <div class="config-group">
                <label for="departmentSelect">Department *</label>
                <select id="departmentSelect" required>
                  <option value="">Select Department</option>
                  <option value="CSE">Computer Science & Engineering</option>
                  <option value="ECE">Electronics & Communication</option>
                  <option value="ME">Mechanical Engineering</option>
                  <option value="CE">Civil Engineering</option>
                </select>
              </div>
            </div>
            <button class="wizard-next" onclick="nextStep(2)">Next ‚Üí</button>
          </div>

          <!-- Step 2: Constraints -->
          <div class="wizard-step" id="step2">
            <h3>2. Set Constraints</h3>
            <div class="constraints-grid">
              <div class="constraint-item">
                <label>Max Classes Per Day:</label>
                <input type="number" id="maxClasses" value="6" min="4" max="8">
              </div>
              <div class="constraint-item">
                <label>Lab Duration (hours):</label>
                <input type="number" id="labDuration" value="2" min="2" max="3">
              </div>
              <div class="constraint-item">
                <label>Lunch Break:</label>
                <select id="lunchBreak">
                  <option value="60">1 hour (12:00-1:00)</option>
                  <option value="45">45 minutes</option>
                  <option value="30">30 minutes</option>
                </select>
              </div>
            </div>
            <div class="wizard-actions">
              <button class="wizard-prev" onclick="prevStep(1)">‚Üê Previous</button>
              <button class="wizard-next" onclick="nextStep(3)">Next ‚Üí</button>
            </div>
          </div>

          <!-- Step 3: Generate -->
          <div class="wizard-step" id="step3">
            <h3>3. Generate Timetable</h3>
            <div class="generate-options">
              <button class="generate-btn primary" onclick="generateTimetable()">
                üöÄ Generate Timetable
              </button>
              <button class="generate-btn secondary" onclick="loadExistingData()">
                üì• Load Existing Data
              </button>
            </div>
            <div class="wizard-actions">
              <button class="wizard-prev" onclick="prevStep(2)">‚Üê Previous</button>
            </div>
          </div>
        </div>

        <!-- Results Section -->
        <div class="results-section" id="resultsSection" style="display: none;">
          <div class="results-header">
            <h3>Generated Timetable</h3>
            <div class="result-actions">
              <button class="action-btn success" onclick="exportTimetable()">üì• Export JSON</button>
              <button class="action-btn primary" onclick="saveTimetable()">üíæ Save to Database</button>
              <button class="action-btn warning" onclick="publishTimetable()">üåê Publish</button>
            </div>
          </div>
          <div id="timetableResults" class="timetable-results">
            <!-- Timetable will be rendered here -->
          </div>
        </div>
      </div>

      <!-- Course Management Section -->
      <div id="course-mgmt" class="content-section">
        <div class="section-header">
          <h2>üìö Course Management</h2>
          <p>Manage all courses and their details</p>
        </div>

        <div class="management-panel">
          <div class="toolbar">
            <button class="action-btn primary" onclick="showAddCourseModal()">
              ‚ûï Add New Course
            </button>
            <button class="action-btn secondary" onclick="importCourses()">
              üì• Import Courses
            </button>
            <button class="action-btn success" onclick="exportCourses()">
              üì§ Export Courses
            </button>
            <div class="search-box">
              <input type="text" id="courseSearch" placeholder="Search courses..." onkeyup="searchCourses()">
              <span class="search-icon">üîç</span>
            </div>
          </div>

          <div class="data-table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Course Code</th>
                  <th>Course Name</th>
                  <th>Teacher</th>
                  <th>Credits</th>
                  <th>Type</th>
                  <th>Department</th>
                  <th>Semester</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="coursesTable">
                <!-- Courses will be loaded here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Faculty Management Section -->
      <div id="faculty-mgmt" class="content-section">
        <div class="section-header">
          <h2>üë®‚Äçüè´ Faculty Management</h2>
          <p>Manage faculty members and their assignments</p>
        </div>

        <div class="management-panel">
          <div class="toolbar">
            <button class="action-btn primary" onclick="showAddFacultyModal()">
              ‚ûï Add New Faculty
            </button>
            <button class="action-btn secondary" onclick="importFaculty()">
              üì• Import Faculty
            </button>
            <button class="action-btn success" onclick="exportFaculty()">
              üì§ Export Faculty
            </button>
            <div class="search-box">
              <input type="text" id="facultySearch" placeholder="Search faculty..." onkeyup="searchFaculty()">
              <span class="search-icon">üîç</span>
            </div>
          </div>

          <div class="data-table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Faculty ID</th>
                  <th>Name</th>
                  <th>Department</th>
                  <th>Email</th>
                  <th>Designation</th>
                  <th>Specialization</th>
                  <th>Experience</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="facultyTable">
                <!-- Faculty will be loaded here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Room Management Section -->
      <div id="room-mgmt" class="content-section">
        <div class="section-header">
          <h2>üè´ Room Management</h2>
          <p>Manage classrooms, labs, and their facilities</p>
        </div>

        <div class="management-panel">
          <div class="toolbar">
            <button class="action-btn primary" onclick="showAddRoomModal()">
              ‚ûï Add New Room
            </button>
            <button class="action-btn secondary" onclick="importRooms()">
              üì• Import Rooms
            </button>
            <button class="action-btn success" onclick="exportRooms()">
              üì§ Export Rooms
            </button>
            <div class="search-box">
              <input type="text" id="roomSearch" placeholder="Search rooms..." onkeyup="searchRooms()">
              <span class="search-icon">üîç</span>
            </div>
          </div>

          <div class="data-table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Room ID</th>
                  <th>Room Name</th>
                  <th>Type</th>
                  <th>Capacity</th>
                  <th>Department</th>
                  <th>Facilities</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="roomsTable">
                <!-- Rooms will be loaded here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Reports Section -->
<div id="reports" class="content-section">
  <div class="section-header">
    <h2>üìà Reports & Analytics</h2>
    <p>System insights and performance metrics</p>
  </div>

  <div class="reports-grid">
    <div class="report-card">
      <h3>üìä Room Utilization</h3>
      <div class="report-content">
        <div class="chart-container" id="roomUtilizationChart">
          <canvas id="roomChart" width="400" height="200"></canvas>
        </div>
      </div>
    </div>
    <div class="report-card">
      <h3>üë®‚Äçüè´ Faculty Workload</h3>
      <div class="report-content">
        <div class="chart-container" id="facultyWorkloadChart">
          <canvas id="facultyChart" width="400" height="200"></canvas>
        </div>
      </div>
    </div>
    <div class="report-card">
      <h3>üìö Course Distribution</h3>
      <div class="report-content">
        <div class="chart-container" id="courseDistributionChart">
          <canvas id="courseChart" width="400" height="200"></canvas>
        </div>
      </div>
    </div>
    <div class="report-card">
      <h3>‚ö° System Statistics</h3>
      <div class="report-content">
        <div class="system-stats">
          <div class="system-stat">
            <span class="stat-label">Total Courses:</span>
            <span class="stat-value" id="reportTotalCourses">0</span>
          </div>
          <div class="system-stat">
            <span class="stat-label">Active Faculty:</span>
            <span class="stat-value" id="reportActiveFaculty">0</span>
          </div>
          <div class="system-stat">
            <span class="stat-label">Available Rooms:</span>
            <span class="stat-value" id="reportAvailableRooms">0</span>
          </div>
          <div class="system-stat">
            <span class="stat-label">Active Timetables:</span>
            <span class="stat-value" id="reportActiveTimetables">0</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

      <!-- Settings Section -->
      <div id="settings" class="content-section">
        <div class="section-header">
          <h2>‚öôÔ∏è System Settings</h2>
          <p>Configure system preferences and defaults</p>
        </div>

        <div class="settings-panel">
          <div class="setting-group">
            <h3>Academic Settings</h3>
            <div class="setting-item">
              <label for="defaultAcademicYear">Default Academic Year</label>
              <input type="text" id="defaultAcademicYear" value="2024-25">
            </div>
            <div class="setting-item">
              <label for="maxClassesPerDay">Maximum Classes Per Day</label>
              <input type="number" id="maxClassesPerDay" value="6" min="4" max="8">
            </div>
          </div>

          <div class="setting-group">
            <h3>Time Settings</h3>
            <div class="setting-item">
              <label for="classStartTime">Class Start Time</label>
              <input type="time" id="classStartTime" value="08:30">
            </div>
            <div class="setting-item">
              <label for="classDuration">Class Duration (minutes)</label>
              <input type="number" id="classDuration" value="60" min="45" max="120">
            </div>
          </div>

          <div class="setting-actions">
            <button class="action-btn primary" onclick="saveSettings()">üíæ Save Settings</button>
            <button class="action-btn secondary" onclick="resetSettings()">üîÑ Reset to Defaults</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Add/Edit Course Modal -->
  <div id="courseModal" class="modal" style="display: none;">
    <div class="modal-content large scrollable">
      <div class="modal-header">
        <h3 id="courseModalTitle">‚ûï Add New Course</h3>
        <button class="modal-close" onclick="hideModal('courseModal')">√ó</button>
      </div>
      <form id="courseForm">
        <input type="hidden" id="courseId">
        <div class="form-row">
          <div class="form-group">
            <label for="courseCode">Course Code *</label>
            <input type="text" id="courseCode" placeholder="e.g., 18CS53" required>
            <div class="form-hint">Unique identifier for the course</div>
          </div>
          <div class="form-group">
            <label for="courseName">Course Name *</label>
            <input type="text" id="courseName" placeholder="e.g., Database Management Systems" required>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="courseCredits">Credits *</label>
            <input type="number" id="courseCredits" min="1" max="5" value="3" required>
            <div class="form-hint">1-5 credits</div>
          </div>
          <div class="form-group">
            <label for="courseType">Course Type *</label>
            <select id="courseType" required>
              <option value="">Select Type</option>
              <option value="theory">Theory</option>
              <option value="lab">Lab</option>
              <option value="project">Project</option>
              <option value="seminar">Seminar</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="courseDepartment">Department *</label>
            <select id="courseDepartment" required>
              <option value="">Select Department</option>
              <option value="CSE">Computer Science & Engineering</option>
              <option value="ECE">Electronics & Communication</option>
              <option value="ME">Mechanical Engineering</option>
              <option value="CE">Civil Engineering</option>
              <option value="EE">Electrical Engineering</option>
            </select>
          </div>
          <div class="form-group">
            <label for="courseSemester">Semester *</label>
            <select id="courseSemester" required>
              <option value="">Select Semester</option>
              <option value="1">Semester 1</option>
              <option value="2">Semester 2</option>
              <option value="3">Semester 3</option>
              <option value="4">Semester 4</option>
              <option value="5">Semester 5</option>
              <option value="6">Semester 6</option>
              <option value="7">Semester 7</option>
              <option value="8">Semester 8</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="courseDescription">Description</label>
          <textarea id="courseDescription" placeholder="Course description, objectives, and learning outcomes..." rows="3"></textarea>
        </div>

        <div class="form-group">
          <label for="assignedFaculty">Assigned Faculty</label>
          <select id="assignedFaculty">
            <option value="">Select Faculty Member</option>
            <!-- Faculty options will be populated dynamically -->
          </select>
        </div>

        <div class="form-group">
          <label>
            <input type="checkbox" id="courseActive" checked>
            Course Active
          </label>
        </div>

        <div class="modal-actions">
          <button type="submit" class="action-btn primary" id="courseSubmitBtn">üíæ Add Course</button>
          <button type="button" class="action-btn secondary" onclick="hideModal('courseModal')">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add/Edit Faculty Modal -->
  <div id="facultyModal" class="modal" style="display: none;">
    <div class="modal-content large scrollable">
      <div class="modal-header">
        <h3 id="facultyModalTitle">üë®‚Äçüè´ Add New Faculty</h3>
        <button class="modal-close" onclick="hideModal('facultyModal')">√ó</button>
      </div>
      <form id="facultyForm">
        <input type="hidden" id="facultyId">
        <div class="form-row">
          <div class="form-group">
            <label for="facultyIdInput">Faculty ID *</label>
            <input type="text" id="facultyIdInput" placeholder="e.g., FAC001" required>
            <div class="form-hint">Unique identifier for faculty</div>
          </div>
          <div class="form-group">
            <label for="facultyDepartment">Department *</label>
            <select id="facultyDepartment" required>
              <option value="">Select Department</option>
              <option value="CSE">Computer Science & Engineering</option>
              <option value="ECE">Electronics & Communication</option>
              <option value="ME">Mechanical Engineering</option>
              <option value="CE">Civil Engineering</option>
              <option value="EE">Electrical Engineering</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="facultyFirstName">First Name *</label>
            <input type="text" id="facultyFirstName" placeholder="e.g., John" required>
          </div>
          <div class="form-group">
            <label for="facultyLastName">Last Name *</label>
            <input type="text" id="facultyLastName" placeholder="e.g., Doe" required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="facultyEmail">Email Address *</label>
            <input type="email" id="facultyEmail" placeholder="e.g., john.doe@college.edu" required>
          </div>
          <div class="form-group">
            <label for="facultyPhone">Phone Number</label>
            <input type="tel" id="facultyPhone" placeholder="e.g., +91 9876543210">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="facultyDesignation">Designation *</label>
            <select id="facultyDesignation" required>
              <option value="">Select Designation</option>
              <option value="professor">Professor</option>
              <option value="associate-professor">Associate Professor</option>
              <option value="assistant-professor">Assistant Professor</option>
              <option value="lecturer">Lecturer</option>
              <option value="visiting-faculty">Visiting Faculty</option>
            </select>
          </div>
          <div class="form-group">
            <label for="facultyQualification">Highest Qualification *</label>
            <select id="facultyQualification" required>
              <option value="">Select Qualification</option>
              <option value="phd">Ph.D.</option>
              <option value="masters">Masters</option>
              <option value="bachelors">Bachelors</option>
              <option value="other">Other</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="facultySpecialization">Specialization</label>
          <input type="text" id="facultySpecialization" placeholder="e.g., Artificial Intelligence, Database Systems">
          <div class="form-hint">Areas of expertise</div>
        </div>

        <div class="form-group">
          <label for="facultyExperience">Years of Experience</label>
          <input type="number" id="facultyExperience" min="0" max="50" value="0">
        </div>

        <div class="form-group">
          <label>Assigned Courses</label>
          <div class="checkbox-grid" id="facultyCoursesGrid">
            <!-- Course checkboxes will be populated dynamically -->
          </div>
        </div>

        <div class="form-group">
          <label>
            <input type="checkbox" id="facultyActive" checked>
            Active Faculty Member
          </label>
        </div>

        <div class="modal-actions">
          <button type="submit" class="action-btn primary" id="facultySubmitBtn">üíæ Add Faculty</button>
          <button type="button" class="action-btn secondary" onclick="hideModal('facultyModal')">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add/Edit Room Modal -->
  <div id="roomModal" class="modal" style="display: none;">
    <div class="modal-content large scrollable">
      <div class="modal-header">
        <h3 id="roomModalTitle">üè´ Add New Room</h3>
        <button class="modal-close" onclick="hideModal('roomModal')">√ó</button>
      </div>
      <form id="roomForm">
        <input type="hidden" id="roomId">
        <div class="form-row">
          <div class="form-group">
            <label for="roomIdInput">Room ID *</label>
            <input type="text" id="roomIdInput" placeholder="e.g., R201, LAB_A1" required>
            <div class="form-hint">Unique identifier for the room</div>
          </div>
          <div class="form-group">
            <label for="roomName">Room Name *</label>
            <input type="text" id="roomName" placeholder="e.g., Room 201, CS Lab A1" required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="roomType">Room Type *</label>
            <select id="roomType" required>
              <option value="">Select Type</option>
              <option value="classroom">Classroom</option>
              <option value="lab">Laboratory</option>
              <option value="seminar-hall">Seminar Hall</option>
              <option value="conference-room">Conference Room</option>
              <option value="auditorium">Auditorium</option>
            </select>
          </div>
          <div class="form-group">
            <label for="roomCapacity">Capacity *</label>
            <input type="number" id="roomCapacity" min="10" max="500" value="60" required>
            <div class="form-hint">Number of students the room can accommodate</div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="roomDepartment">Department *</label>
            <select id="roomDepartment" required>
              <option value="">Select Department</option>
              <option value="CSE">Computer Science & Engineering</option>
              <option value="ECE">Electronics & Communication</option>
              <option value="ME">Mechanical Engineering</option>
              <option value="CE">Civil Engineering</option>
              <option value="EE">Electrical Engineering</option>
              <option value="common">Common</option>
            </select>
          </div>
          <div class="form-group">
            <label for="roomFloor">Floor</label>
            <select id="roomFloor">
              <option value="">Select Floor</option>
              <option value="ground">Ground Floor</option>
              <option value="first">First Floor</option>
              <option value="second">Second Floor</option>
              <option value="third">Third Floor</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label>Facilities Available</label>
          <div class="checkbox-grid">
            <label class="checkbox-item">
              <input type="checkbox" name="facilities" value="projector"> Projector
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="facilities" value="ac"> Air Conditioning
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="facilities" value="whiteboard"> Whiteboard
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="facilities" value="computers"> Computers
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="facilities" value="sound-system"> Sound System
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="facilities" value="wifi"> WiFi
            </label>
          </div>
        </div>

        <div class="form-group">
          <label for="roomDescription">Additional Notes</label>
          <textarea id="roomDescription" placeholder="Any additional information about the room..." rows="2"></textarea>
        </div>

        <div class="form-group">
          <label>
            <input type="checkbox" id="roomAvailable" checked>
            Room Available for Scheduling
          </label>
        </div>

        <div class="modal-actions">
          <button type="submit" class="action-btn primary" id="roomSubmitBtn">üíæ Add Room</button>
          <button type="button" class="action-btn secondary" onclick="hideModal('roomModal')">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div id="confirmationModal" class="modal" style="display: none;">
    <div class="modal-content small">
      <div class="modal-header">
        <h3>Confirm Action</h3>
        <button class="modal-close" onclick="hideModal('confirmationModal')">√ó</button>
      </div>
      <div class="modal-body">
        <p id="confirmationMessage">Are you sure you want to perform this action?</p>
      </div>
      <div class="modal-actions">
        <button class="action-btn danger" id="confirmActionBtn">Confirm</button>
        <button class="action-btn secondary" onclick="hideModal('confirmationModal')">Cancel</button>
      </div>
    </div>
  </div>

  <script type="module">
  import { authManager } from './auth.js';
  import { databaseManager } from './database-manager.js';

  class AdminDashboard {
    constructor() {
      this.currentData = {
        courses: [],
        faculty: [],
        rooms: [],
        activities: [],
        editingItem: null
      };
      this.init();
    }

    init() {
    document.addEventListener('DOMContentLoaded', async () => {
        console.log('Admin dashboard loaded');
        
        if (!authManager.requireAuth('admin')) {
            return;
        }

        console.log('Admin authentication successful');
        
        this.loadUserInfo();
        await this.ensureSampleData(); // üëà THIS IS THE CRITICAL LINE TO ADD
        await this.loadAllData();
        await this.initializeCharts();
        this.setupEventListeners();
        this.setupFormHandlers();
    });
}
    // Add to AdminDashboard class
async ensureSampleData() {
  const coursesRes = await databaseManager.getCourses();
  if (coursesRes.data.length === 0) {
    // Add sample courses
    const sampleCourses = [
      {
        code: "CSE501",
        name: "Database Management Systems",
        credits: 4,
        type: "theory",
        department: "CSE",
        semester: "5",
        description: "Database concepts and SQL",
        active: true
      },
      {
        code: "CSE501L",
        name: "DBMS Laboratory",
        credits: 2,
        type: "lab",
        department: "CSE",
        semester: "5",
        description: "Practical database implementation",
        active: true
      },
      {
        code: "CSE502",
        name: "Advanced Java Programming",
        credits: 3,
        type: "theory",
        department: "CSE",
        semester: "5",
        description: "Advanced Java concepts",
        active: true
      }
    ];
    
    for (const course of sampleCourses) {
      await databaseManager.createCourse(course);
    }
  }
}

    loadUserInfo() {
      const userData = JSON.parse(localStorage.getItem('userData'));
      if (userData) {
        document.getElementById('adminName').textContent = `Welcome, ${userData.firstName} ${userData.lastName}`;
      }
    }

    async loadAllData() {
      try {
        const [coursesRes, facultyRes, roomsRes] = await Promise.all([
          databaseManager.getCourses(),
          databaseManager.getFaculty(),
          databaseManager.getRooms()
        ]);

        if (coursesRes.success) this.currentData.courses = coursesRes.data;
        if (facultyRes.success) this.currentData.faculty = facultyRes.data;
        if (roomsRes.success) this.currentData.rooms = roomsRes.data;

        this.currentData.activities = await this.loadActivities();
        
        this.renderAllTables();
        this.updateDashboardStats();
        
      } catch (error) {
        console.error('Error loading data:', error);
        this.showNotification('Error loading data: ' + error.message, 'error');
      }
    }

    async loadActivities() {
      return JSON.parse(localStorage.getItem('admin_activities')) || [];
    }

    async saveActivity(activity) {
      const activities = await this.loadActivities();
      activities.unshift({
        id: Date.now().toString(),
        ...activity,
        timestamp: new Date().toISOString()
      });
      
      if (activities.length > 10) activities.pop();
      
      localStorage.setItem('admin_activities', JSON.stringify(activities));
      this.currentData.activities = activities;
      this.renderRecentActivity();
    }
    // Add these methods to the AdminDashboard class

async initializeCharts() {
  await this.loadChartData();
  this.renderCharts();
}

async loadChartData() {
  // This would be populated with real data
  this.chartData = {
    roomUtilization: {
      labels: ['Room 201', 'Room 202', 'Lab A1', 'Lab A2', 'Seminar Hall'],
      data: [65, 59, 80, 81, 56]
    },
    facultyWorkload: {
      labels: ['Dr. Franklin', 'Dr. Priya', 'Prof. Sharma', 'Dr. Novel'],
      data: [12, 19, 8, 15]
    },
    courseDistribution: {
      labels: ['Theory', 'Lab', 'Project', 'Seminar'],
      data: [40, 25, 20, 15]
    }
  };
}

renderCharts() {
  this.renderRoomUtilizationChart();
  this.renderFacultyWorkloadChart();
  this.renderCourseDistributionChart();
  this.updateReportStats();
}

renderRoomUtilizationChart() {
  const ctx = document.getElementById('roomChart');
  if (!ctx) return;
  
  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: this.chartData.roomUtilization.labels,
      datasets: [{
        label: 'Utilization %',
        data: this.chartData.roomUtilization.data,
        backgroundColor: [
          'rgba(37, 99, 235, 0.8)',
          'rgba(59, 130, 246, 0.8)',
          'rgba(96, 165, 250, 0.8)',
          'rgba(147, 197, 253, 0.8)',
          'rgba(191, 219, 254, 0.8)'
        ],
        borderColor: [
          'rgb(37, 99, 235)',
          'rgb(59, 130, 246)',
          'rgb(96, 165, 250)',
          'rgb(147, 197, 253)',
          'rgb(191, 219, 254)'
        ],
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          display: false
        },
        title: {
          display: true,
          text: 'Room Utilization Rate'
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          max: 100
        }
      }
    }
  });
}

renderFacultyWorkloadChart() {
  const ctx = document.getElementById('facultyChart');
  if (!ctx) return;
  
  new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: this.chartData.facultyWorkload.labels,
      datasets: [{
        label: 'Hours per Week',
        data: this.chartData.facultyWorkload.data,
        backgroundColor: [
          'rgba(37, 99, 235, 0.8)',
          'rgba(16, 185, 129, 0.8)',
          'rgba(245, 158, 11, 0.8)',
          'rgba(239, 68, 68, 0.8)'
        ],
        borderColor: [
          'rgb(37, 99, 235)',
          'rgb(16, 185, 129)',
          'rgb(245, 158, 11)',
          'rgb(239, 68, 68)'
        ],
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: 'bottom'
        }
      }
    }
  });
}

renderCourseDistributionChart() {
  const ctx = document.getElementById('courseChart');
  if (!ctx) return;
  
  new Chart(ctx, {
    type: 'pie',
    data: {
      labels: this.chartData.courseDistribution.labels,
      datasets: [{
        label: 'Course Types',
        data: this.chartData.courseDistribution.data,
        backgroundColor: [
          'rgba(37, 99, 235, 0.8)',
          'rgba(16, 185, 129, 0.8)',
          'rgba(245, 158, 11, 0.8)',
          'rgba(139, 92, 246, 0.8)'
        ],
        borderColor: [
          'rgb(37, 99, 235)',
          'rgb(16, 185, 129)',
          'rgb(245, 158, 11)',
          'rgb(139, 92, 246)'
        ],
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: 'bottom'
        }
      }
    }
  });
}

updateReportStats() {
  document.getElementById('reportTotalCourses').textContent = this.currentData.courses.length;
  document.getElementById('reportActiveFaculty').textContent = this.currentData.faculty.length;
  document.getElementById('reportAvailableRooms').textContent = this.currentData.rooms.length;
  document.getElementById('reportActiveTimetables').textContent = this.currentData.timetables.length;
}

    renderAllTables() {
      this.renderCoursesTable();
      this.renderFacultyTable();
      this.renderRoomsTable();
      this.renderRecentActivity();
      this.populateFacultyDropdown();
      this.populateCourseCheckboxes();
    }

    renderCoursesTable() {
      const tbody = document.getElementById('coursesTable');
      if (this.currentData.courses.length === 0) {
        tbody.innerHTML = `<tr><td colspan="9" class="no-data">No courses found. <a href="javascript:void(0)" onclick="showAddCourseModal()">Add your first course</a></td></tr>`;
        return;
      }

      tbody.innerHTML = this.currentData.courses.map(course => `
        <tr>
          <td><strong>${course.code}</strong></td>
          <td>
            <div class="course-name">${course.name}</div>
            ${course.description ? `<div class="course-desc">${course.description}</div>` : ''}
          </td>
          <td>${course.teacher || '<span class="text-muted">Not assigned</span>'}</td>
          <td>${course.credits}</td>
          <td><span class="badge ${course.type}">${course.type}</span></td>
          <td>${course.department}</td>
          <td>Semester ${course.semester}</td>
          <td><span class="badge ${course.active ? 'active' : 'inactive'}">${course.active ? 'Active' : 'Inactive'}</span></td>
          <td>
            <div class="action-buttons">
              <button class="btn-icon edit" onclick="adminDashboard.editCourse('${course.id}')" title="Edit">‚úèÔ∏è</button>
              <button class="btn-icon delete" onclick="adminDashboard.confirmDelete('course', '${course.id}', '${course.name}')" title="Delete">üóëÔ∏è</button>
            </div>
          </td>
        </tr>
      `).join('');
    }

    renderFacultyTable() {
      const tbody = document.getElementById('facultyTable');
      if (this.currentData.faculty.length === 0) {
        tbody.innerHTML = `<tr><td colspan="9" class="no-data">No faculty members found. <a href="javascript:void(0)" onclick="showAddFacultyModal()">Add your first faculty member</a></td></tr>`;
        return;
      }

      tbody.innerHTML = this.currentData.faculty.map(faculty => `
        <tr>
          <td><strong>${faculty.facultyId}</strong></td>
          <td>${faculty.name}</td>
          <td>${faculty.department}</td>
          <td>${faculty.email}</td>
          <td>${this.formatDesignation(faculty.designation)}</td>
          <td>${faculty.specialization || 'General'}</td>
          <td>${faculty.experience} years</td>
          <td><span class="badge ${faculty.active ? 'active' : 'inactive'}">${faculty.active ? 'Active' : 'Inactive'}</span></td>
          <td>
            <div class="action-buttons">
              <button class="btn-icon edit" onclick="adminDashboard.editFaculty('${faculty.id}')" title="Edit">‚úèÔ∏è</button>
              <button class="btn-icon delete" onclick="adminDashboard.confirmDelete('faculty', '${faculty.id}', '${faculty.name}')" title="Delete">üóëÔ∏è</button>
            </div>
          </td>
        </tr>
      `).join('');
    }

    renderRoomsTable() {
      const tbody = document.getElementById('roomsTable');
      if (this.currentData.rooms.length === 0) {
        tbody.innerHTML = `<tr><td colspan="8" class="no-data">No rooms found. <a href="javascript:void(0)" onclick="showAddRoomModal()">Add your first room</a></td></tr>`;
        return;
      }

      tbody.innerHTML = this.currentData.rooms.map(room => `
        <tr>
          <td><strong>${room.roomId}</strong></td>
          <td>${room.name}</td>
          <td><span class="badge ${room.type}">${room.type}</span></td>
          <td>${room.capacity} seats</td>
          <td>${room.department}</td>
          <td>
            <div class="facilities-tags">
              ${room.facilities?.map(facility => `<span class="facility-tag">${facility}</span>`).join('') || ''}
            </div>
          </td>
          <td><span class="badge ${room.available ? 'active' : 'inactive'}">${room.available ? 'Available' : 'Unavailable'}</span></td>
          <td>
            <div class="action-buttons">
              <button class="btn-icon edit" onclick="adminDashboard.editRoom('${room.id}')" title="Edit">‚úèÔ∏è</button>
              <button class="btn-icon delete" onclick="adminDashboard.confirmDelete('room', '${room.id}', '${room.name}')" title="Delete">üóëÔ∏è</button>
            </div>
          </td>
        </tr>
      `).join('');
    }

    renderRecentActivity() {
      const container = document.getElementById('recentActivityList');
      container.innerHTML = this.currentData.activities.map(activity => `
        <div class="activity-item">
          <div class="activity-icon ${activity.type}">${this.getActivityIcon(activity.type)}</div>
          <div class="activity-content">
            <p><strong>${activity.message}</strong></p>
            <span class="activity-time">${this.formatRelativeTime(activity.timestamp)} ‚Ä¢ by Admin</span>
          </div>
        </div>
      `).join('');
    }

    populateFacultyDropdown() {
      const select = document.getElementById('assignedFaculty');
      select.innerHTML = '<option value="">Select Faculty Member</option>' +
        this.currentData.faculty.map(faculty => 
          `<option value="${faculty.id}">${faculty.name} (${faculty.facultyId})</option>`
        ).join('');
    }

    populateCourseCheckboxes() {
      const container = document.getElementById('facultyCoursesGrid');
      container.innerHTML = this.currentData.courses.map(course => `
        <label class="checkbox-item">
          <input type="checkbox" name="facultyCourses" value="${course.id}">
          ${course.code} - ${course.name}
        </label>
      `).join('');
    }

    setupEventListeners() {
      document.getElementById('courseSearch').addEventListener('input', (e) => {
        this.searchCourses(e.target.value);
      });
      
      document.getElementById('facultySearch').addEventListener('input', (e) => {
        this.searchFaculty(e.target.value);
      });
      
      document.getElementById('roomSearch').addEventListener('input', (e) => {
        this.searchRooms(e.target.value);
      });
    }

    setupFormHandlers() {
      document.getElementById('courseForm').addEventListener('submit', (e) => {
        e.preventDefault();
        this.saveCourse();
      });

      document.getElementById('facultyForm').addEventListener('submit', (e) => {
        e.preventDefault();
        this.saveFaculty();
      });

      document.getElementById('roomForm').addEventListener('submit', (e) => {
        e.preventDefault();
        this.saveRoom();
      });
    }

    async saveCourse() {
  const formData = {
    code: document.getElementById('courseCode').value.trim(),
    name: document.getElementById('courseName').value.trim(),
    credits: parseInt(document.getElementById('courseCredits').value),
    type: document.getElementById('courseType').value,
    department: document.getElementById('courseDepartment').value,
    semester: document.getElementById('courseSemester').value,
    description: document.getElementById('courseDescription').value.trim(),
    active: document.getElementById('courseActive').checked
  };

  const facultyId = document.getElementById('assignedFaculty').value;
  if (facultyId) {
    const faculty = this.currentData.faculty.find(f => f.id === facultyId);
    formData.teacher = faculty ? faculty.name : null;
  } else {
    formData.teacher = null;
  }

  if (!this.validateCourse(formData)) return;

  try {
    let result;
    
    if (this.currentData.editingItem?.type === 'course') {
      // UPDATE existing course
      result = await databaseManager.updateCourse(this.currentData.editingItem.id, formData);
      if (result.success) {
        await this.loadAllData();
        this.showNotification('Course updated successfully!', 'success');
        this.saveActivity({ type: 'course', message: `${formData.name} course was updated` });
      }
    } else {
      // CREATE new course
      result = await databaseManager.createCourse(formData);
      if (result.success) {
        await this.loadAllData();
        this.showNotification('Course added successfully!', 'success');
        this.saveActivity({ type: 'course', message: `${formData.name} course was added` });
      }
    }
    
    if (result.success) {
      this.hideModal('courseModal');
      this.resetForm('courseForm');
      this.currentData.editingItem = null;
    } else {
      this.showNotification('Error: ' + result.error, 'error');
    }
  } catch (error) {
    this.showNotification('Error saving course: ' + error.message, 'error');
  }
}

async saveFaculty() {
  const assignedCourses = Array.from(document.querySelectorAll('input[name="facultyCourses"]:checked'))
                             .map(checkbox => checkbox.value);

  const formData = {
    facultyId: document.getElementById('facultyIdInput').value.trim(),
    firstName: document.getElementById('facultyFirstName').value.trim(),
    lastName: document.getElementById('facultyLastName').value.trim(),
    name: `${document.getElementById('facultyFirstName').value.trim()} ${document.getElementById('facultyLastName').value.trim()}`,
    department: document.getElementById('facultyDepartment').value,
    email: document.getElementById('facultyEmail').value.trim(),
    phone: document.getElementById('facultyPhone').value.trim(),
    designation: document.getElementById('facultyDesignation').value,
    qualification: document.getElementById('facultyQualification').value,
    specialization: document.getElementById('facultySpecialization').value.trim(),
    experience: parseInt(document.getElementById('facultyExperience').value) || 0,
    courses: assignedCourses,
    active: document.getElementById('facultyActive').checked
  };

  if (!this.validateFaculty(formData)) return;

  try {
    let result;
    
    if (this.currentData.editingItem?.type === 'faculty') {
      // UPDATE existing faculty
      result = await databaseManager.updateFaculty(this.currentData.editingItem.id, formData);
      if (result.success) {
        await this.loadAllData();
        this.showNotification('Faculty updated successfully!', 'success');
        this.saveActivity({ type: 'faculty', message: `${formData.name} was updated` });
      }
    } else {
      // CREATE new faculty
      result = await databaseManager.createFaculty(formData);
      if (result.success) {
        await this.loadAllData();
        this.showNotification('Faculty added successfully!', 'success');
        this.saveActivity({ type: 'faculty', message: `${formData.name} was added as faculty` });
      }
    }
    
    if (result.success) {
      this.hideModal('facultyModal');
      this.resetForm('facultyForm');
      this.currentData.editingItem = null;
    } else {
      this.showNotification('Error: ' + result.error, 'error');
    }
  } catch (error) {
    this.showNotification('Error saving faculty: ' + error.message, 'error');
  }
}

async saveRoom() {
  const facilities = Array.from(document.querySelectorAll('input[name="facilities"]:checked'))
                        .map(checkbox => checkbox.value);

  const formData = {
    roomId: document.getElementById('roomIdInput').value.trim(),
    name: document.getElementById('roomName').value.trim(),
    type: document.getElementById('roomType').value,
    capacity: parseInt(document.getElementById('roomCapacity').value),
    department: document.getElementById('roomDepartment').value,
    floor: document.getElementById('roomFloor').value,
    facilities: facilities,
    description: document.getElementById('roomDescription').value.trim(),
    available: document.getElementById('roomAvailable').checked
  };

  if (!this.validateRoom(formData)) return;

  try {
    let result;
    
    if (this.currentData.editingItem?.type === 'room') {
      // UPDATE existing room
      result = await databaseManager.updateRoom(this.currentData.editingItem.id, formData);
      if (result.success) {
        await this.loadAllData();
        this.showNotification('Room updated successfully!', 'success');
        this.saveActivity({ type: 'room', message: `${formData.name} room was updated` });
      }
    } else {
      // CREATE new room
      result = await databaseManager.createRoom(formData);
      if (result.success) {
        await this.loadAllData();
        this.showNotification('Room added successfully!', 'success');
        this.saveActivity({ type: 'room', message: `${formData.name} room was added` });
      }
    }
    
    if (result.success) {
      this.hideModal('roomModal');
      this.resetForm('roomForm');
      this.currentData.editingItem = null;
    } else {
      this.showNotification('Error: ' + result.error, 'error');
    }
  } catch (error) {
    this.showNotification('Error saving room: ' + error.message, 'error');
  }
}

    validateCourse(data) {
      if (!data.code || !data.name) {
        this.showNotification('Course code and name are required', 'error');
        return false;
      }
      return true;
    }

    validateFaculty(data) {
      if (!data.facultyId || !data.firstName || !data.lastName || !data.email) {
        this.showNotification('Faculty ID, name, and email are required', 'error');
        return false;
      }
      return true;
    }

    validateRoom(data) {
      if (!data.roomId || !data.name) {
        this.showNotification('Room ID and name are required', 'error');
        return false;
      }
      return true;
    }

    resetForm(formId) {
      document.getElementById(formId).reset();
      document.getElementById('courseModalTitle').textContent = '‚ûï Add New Course';
      document.getElementById('courseSubmitBtn').textContent = 'üíæ Add Course';
      document.getElementById('facultyModalTitle').textContent = 'üë®‚Äçüè´ Add New Faculty';
      document.getElementById('facultySubmitBtn').textContent = 'üíæ Add Faculty';
      document.getElementById('roomModalTitle').textContent = 'üè´ Add New Room';
      document.getElementById('roomSubmitBtn').textContent = 'üíæ Add Room';
    }

    async searchCourses(query) {
      if (!query.trim()) {
        await this.loadAllData();
        return;
      }
      
      const result = await databaseManager.searchCourses(query);
      if (result.success) {
        this.currentData.courses = result.data;
        this.renderCoursesTable();
      }
    }

    async searchFaculty(query) {
      if (!query.trim()) {
        await this.loadAllData();
        return;
      }
      
      const result = await databaseManager.searchFaculty(query);
      if (result.success) {
        this.currentData.faculty = result.data;
        this.renderFacultyTable();
      }
    }

    async searchRooms(query) {
      if (!query.trim()) {
        await this.loadAllData();
        return;
      }
      
      const result = await databaseManager.searchRooms(query);
      if (result.success) {
        this.currentData.rooms = result.data;
        this.renderRoomsTable();
      }
    }

    async updateDashboardStats() {
      const stats = await databaseManager.getDashboardStats();
      document.getElementById('totalCourses').textContent = stats.totalCourses;
      document.getElementById('totalFaculty').textContent = stats.totalFaculty;
      document.getElementById('totalRooms').textContent = stats.totalRooms;
      
      document.getElementById('dashboardCourses').textContent = stats.totalCourses;
      document.getElementById('dashboardFaculty').textContent = stats.totalFaculty;
      document.getElementById('dashboardRooms').textContent = stats.totalRooms;
      document.getElementById('dashboardTimetables').textContent = stats.totalTimetables;
    }

    formatDesignation(designation) {
      const designations = {
        'professor': 'Professor',
        'associate-professor': 'Associate Professor',
        'assistant-professor': 'Assistant Professor',
        'lecturer': 'Lecturer',
        'visiting-faculty': 'Visiting Faculty'
      };
      return designations[designation] || designation;
    }

    formatRelativeTime(timestamp) {
      const now = new Date();
      const time = new Date(timestamp);
      const diffInMinutes = Math.floor((now - time) / (1000 * 60));
      
      if (diffInMinutes < 1) return 'Just now';
      if (diffInMinutes < 60) return `${diffInMinutes}m ago`;
      if (diffInMinutes < 1440) return `${Math.floor(diffInMinutes / 60)}h ago`;
      return `${Math.floor(diffInMinutes / 1440)}d ago`;
    }

    getActivityIcon(type) {
      const icons = {
        'course': 'üìö',
        'faculty': 'üë®‚Äçüè´',
        'room': 'üè´',
        'student': 'üë•',
        'timetable': 'üéØ'
      };
      return icons[type] || 'üìã';
    }

    showModal(modalId) {
      document.getElementById(modalId).style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    hideModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
      document.body.style.overflow = 'auto';
      this.currentData.editingItem = null;
      this.resetForm(modalId.replace('Modal', 'Form'));
    }

    showNotification(message, type) {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.innerHTML = `
        <div class="notification-content">
          <span class="notification-icon">${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è'}</span>
          <span class="notification-message">${message}</span>
        </div>
      `;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, 5000);
    }

    editCourse(courseId) {
      const course = this.currentData.courses.find(c => c.id === courseId);
      if (course) {
        this.currentData.editingItem = { type: 'course', id: courseId };
        document.getElementById('courseId').value = course.id;
        document.getElementById('courseCode').value = course.code;
        document.getElementById('courseName').value = course.name;
        document.getElementById('courseCredits').value = course.credits;
        document.getElementById('courseType').value = course.type;
        document.getElementById('courseDepartment').value = course.department;
        document.getElementById('courseSemester').value = course.semester;
        document.getElementById('courseDescription').value = course.description || '';
        document.getElementById('courseActive').checked = course.active;
        
        document.getElementById('courseModalTitle').textContent = '‚úèÔ∏è Edit Course';
        document.getElementById('courseSubmitBtn').textContent = 'üíæ Update Course';
        this.showModal('courseModal');
      }
    }

    editFaculty(facultyId) {
      const faculty = this.currentData.faculty.find(f => f.id === facultyId);
      if (faculty) {
        this.currentData.editingItem = { type: 'faculty', id: facultyId };
        document.getElementById('facultyId').value = faculty.id;
        document.getElementById('facultyIdInput').value = faculty.facultyId;
        document.getElementById('facultyFirstName').value = faculty.firstName;
        document.getElementById('facultyLastName').value = faculty.lastName;
        document.getElementById('facultyDepartment').value = faculty.department;
        document.getElementById('facultyEmail').value = faculty.email;
        document.getElementById('facultyPhone').value = faculty.phone || '';
        document.getElementById('facultyDesignation').value = faculty.designation;
        document.getElementById('facultyQualification').value = faculty.qualification;
        document.getElementById('facultySpecialization').value = faculty.specialization || '';
        document.getElementById('facultyExperience').value = faculty.experience;
        document.getElementById('facultyActive').checked = faculty.active;
        
        document.getElementById('facultyModalTitle').textContent = '‚úèÔ∏è Edit Faculty';
        document.getElementById('facultySubmitBtn').textContent = 'üíæ Update Faculty';
        this.showModal('facultyModal');
      }
    }

    editRoom(roomId) {
      const room = this.currentData.rooms.find(r => r.id === roomId);
      if (room) {
        this.currentData.editingItem = { type: 'room', id: roomId };
        document.getElementById('roomId').value = room.id;
        document.getElementById('roomIdInput').value = room.roomId;
        document.getElementById('roomName').value = room.name;
        document.getElementById('roomType').value = room.type;
        document.getElementById('roomCapacity').value = room.capacity;
        document.getElementById('roomDepartment').value = room.department;
        document.getElementById('roomFloor').value = room.floor || '';
        document.getElementById('roomDescription').value = room.description || '';
        document.getElementById('roomAvailable').checked = room.available;
        
        document.getElementById('roomModalTitle').textContent = '‚úèÔ∏è Edit Room';
        document.getElementById('roomSubmitBtn').textContent = 'üíæ Update Room';
        this.showModal('roomModal');
      }
    }

    confirmDelete(type, id, name) {
      const message = `Are you sure you want to delete ${type} "${name}"? This action cannot be undone.`;
      document.getElementById('confirmationMessage').textContent = message;
      
      const confirmBtn = document.getElementById('confirmActionBtn');
      confirmBtn.onclick = () => this.deleteItem(type, id);
      
      this.showModal('confirmationModal');
    }

    async deleteItem(type, id) {
      let result;
      switch(type) {
        case 'course':
          result = await databaseManager.deleteCourse(id);
          break;
        case 'faculty':
          result = await databaseManager.deleteFaculty(id);
          break;
        case 'room':
          result = await databaseManager.deleteRoom(id);
          break;
      }
      
      if (result.success) {
        await this.loadAllData();
        this.showNotification(`${type.charAt(0).toUpperCase() + type.slice(1)} deleted successfully!`, 'success');
      } else {
        this.showNotification(`Error deleting ${type}: ` + result.error, 'error');
      }
      
      this.hideModal('confirmationModal');
    }
  // Add these methods to the AdminDashboard class in admin.html

async generateTimetable() {
  try {
    this.showNotification('üöÄ Generating timetable...', 'info');
    
    // Get configuration from the form
    const academicYear = document.getElementById('academicYear').value || '2024-25';
    const semester = document.getElementById('semesterSelect').value || '5';
    const department = document.getElementById('departmentSelect').value || 'CSE';
    
    // Show results section
    document.getElementById('resultsSection').style.display = 'block';
    
    // Generate timetable using actual data
    const generatedTimetable = await this.generateTimetableFromData(academicYear, semester, department);
    
    // Render the timetable
    document.getElementById('timetableResults').innerHTML = this.renderTimetableTable(generatedTimetable);
    
    this.showNotification('‚úÖ Timetable generated successfully!', 'success');
    
    // Save to database
    await databaseManager.createTimetable({
      academicYear,
      semester,
      department,
      timetable: generatedTimetable,
      generatedAt: new Date().toISOString(),
      status: 'generated'
    });
    
  } catch (error) {
    this.showNotification('‚ùå Error generating timetable: ' + error.message, 'error');
    console.error('Timetable generation error:', error);
  }
}

async generateTimetableFromData(academicYear, semester, department) {
  // Get data from database
  const [coursesRes, facultyRes, roomsRes] = await Promise.all([
    databaseManager.getCourses(),
    databaseManager.getFaculty(),
    databaseManager.getRooms()
  ]);

  const courses = coursesRes.success ? coursesRes.data : [];
  const faculty = facultyRes.success ? facultyRes.data : [];
  const rooms = roomsRes.success ? roomsRes.data : [];

  // Filter courses for the selected department and semester
  const departmentCourses = courses.filter(course => 
    course.department === department && course.semester === semester
  );

  if (departmentCourses.length === 0) {
    throw new Error(`No courses found for ${department} Semester ${semester}`);
  }

  // Generate timetable structure
  const timetable = {
    academicYear,
    semester,
    department,
    days: {
      "Monday": this.generateDaySchedule(departmentCourses, faculty, rooms, "Monday"),
      "Tuesday": this.generateDaySchedule(departmentCourses, faculty, rooms, "Tuesday"),
      "Wednesday": this.generateDaySchedule(departmentCourses, faculty, rooms, "Wednesday"),
      "Thursday": this.generateDaySchedule(departmentCourses, faculty, rooms, "Thursday"),
      "Friday": this.generateDaySchedule(departmentCourses, faculty, rooms, "Friday")
    },
    generatedAt: new Date().toISOString()
  };

  return timetable;
}

generateDaySchedule(courses, faculty, rooms, day) {
  const schedule = [];
  const timeSlots = [
    { start: "8:30", end: "9:30", duration: 1 },
    { start: "9:30", end: "10:30", duration: 1 },
    { start: "10:30", end: "11:00", duration: 0.5, isBreak: true, type: "Break" },
    { start: "11:00", end: "12:00", duration: 1 },
    { start: "12:00", end: "1:00", duration: 1, isLunch: true, type: "Lunch" },
    { start: "1:00", end: "2:00", duration: 1 },
    { start: "2:00", end: "4:00", duration: 2 }
  ];

  // Available courses for scheduling
  const availableCourses = [...courses];
  const scheduledCourses = new Set();

  timeSlots.forEach(slot => {
    if (slot.isBreak || slot.isLunch) {
      schedule.push({
        time: `${slot.start}-${slot.end}`,
        course: slot.type,
        type: slot.type,
        isBreak: slot.isBreak,
        isLunch: slot.isLunch,
        duration: slot.duration
      });
      return;
    }

    // Find available course that hasn't been scheduled today
    let scheduledCourse = null;
    for (let i = 0; i < availableCourses.length; i++) {
      const course = availableCourses[i];
      if (!scheduledCourses.has(course.id)) {
        // Find assigned faculty
        const courseFaculty = faculty.find(f => 
          f.courses && f.courses.includes(course.id)
        ) || faculty[Math.floor(Math.random() * faculty.length)];
        
        // Find suitable room based on course type
        const suitableRooms = rooms.filter(room => 
          room.type === (course.type === 'lab' ? 'lab' : 'classroom') && 
          room.available
        );
        
        const suitableRoom = suitableRooms.length > 0 
          ? suitableRooms[Math.floor(Math.random() * suitableRooms.length)]
          : { name: 'Room 201', type: 'classroom' };

        scheduledCourse = {
          time: `${slot.start}-${slot.end}`,
          course: course.name,
          code: course.code,
          teacher: courseFaculty ? courseFaculty.name : 'Staff',
          room: suitableRoom.name,
          type: course.type === 'lab' ? 'Lab' : 'Theory',
          duration: slot.duration,
          credits: course.credits
        };

        scheduledCourses.add(course.id);
        availableCourses.splice(i, 1);
        break;
      }
    }

    if (scheduledCourse) {
      schedule.push(scheduledCourse);
    } else {
      // Free period if no courses available
      schedule.push({
        time: `${slot.start}-${slot.end}`,
        course: "Free Period",
        type: "Free",
        isFree: true,
        duration: slot.duration
      });
    }
  });

  return schedule;
}

renderTimetableTable(timetable) {
  let html = `
    <div class="timetable-container">
      <div class="timetable-header">
        <h3>üìÖ Generated Timetable - ${timetable.department} Semester ${timetable.semester}</h3>
        <p>Academic Year: ${timetable.academicYear} | Generated: ${new Date(timetable.generatedAt).toLocaleString()}</p>
      </div>
      
      <div class="timetable-table-container">
        <table class="timetable-table">
          <thead>
            <tr>
              <th>Time</th>
              <th>Monday</th>
              <th>Tuesday</th>
              <th>Wednesday</th>
              <th>Thursday</th>
              <th>Friday</th>
            </tr>
          </thead>
          <tbody>
  `;

  // Create time slots mapping
  const timeSlots = [
    "8:30-9:30", "9:30-10:30", "10:30-11:00", 
    "11:00-12:00", "12:00-1:00", "1:00-2:00", "2:00-4:00"
  ];

  timeSlots.forEach(timeSlot => {
    html += `<tr>`;
    html += `<td class="time-slot">${timeSlot}</td>`;
    
    const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];
    days.forEach(day => {
      const classes = timetable.days[day] || [];
      const classItem = classes.find(cls => cls.time === timeSlot);
      
      if (classItem) {
        let cellClass = 'timetable-cell';
        if (classItem.isBreak) cellClass += ' break-cell';
        else if (classItem.isLunch) cellClass += ' lunch-cell';
        else if (classItem.isFree) cellClass += ' free-cell';
        else if (classItem.type === 'Lab') cellClass += ' lab-cell';
        else cellClass += ' theory-cell';
        
        html += `<td class="${cellClass}">`;
        
        if (classItem.isBreak || classItem.isLunch || classItem.isFree) {
          html += `<div class="special-slot">${classItem.course}</div>`;
        } else {
          html += `
            <div class="course-info">
              <div class="course-code">${classItem.code}</div>
              <div class="course-name">${classItem.course}</div>
              <div class="course-details">
                <span class="teacher">üë®‚Äçüè´ ${classItem.teacher}</span>
                <span class="room">üè´ ${classItem.room}</span>
                <span class="type">${classItem.type}</span>
                ${classItem.duration > 1 ? `<span class="duration">${classItem.duration}hr</span>` : ''}
              </div>
            </div>
          `;
        }
        html += `</td>`;
      } else {
        html += `<td class="timetable-cell empty-cell">-</td>`;
      }
    });
    
    html += `</tr>`;
  });

  html += `
          </tbody>
        </table>
      </div>
      
      <div class="timetable-legend">
        <div class="legend-item"><div class="color-box theory-cell"></div> Theory Class</div>
        <div class="legend-item"><div class="color-box lab-cell"></div> Lab Session</div>
        <div class="legend-item"><div class="color-box break-cell"></div> Break</div>
        <div class="legend-item"><div class="color-box lunch-cell"></div> Lunch</div>
        <div class="legend-item"><div class="color-box free-cell"></div> Free Period</div>
      </div>
      
      <div class="timetable-stats">
        <h4>üìä Timetable Statistics</h4>
        <div class="stats-grid">
          <div class="stat-item">
            <span class="stat-number">${this.calculateTotalClasses(timetable)}</span>
            <span class="stat-label">Total Classes</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">${this.calculateTotalHours(timetable)}</span>
            <span class="stat-label">Hours/Week</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">${this.calculateUniqueCourses(timetable)}</span>
            <span class="stat-label">Courses</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">${this.calculateLabSessions(timetable)}</span>
            <span class="stat-label">Lab Sessions</span>
          </div>
        </div>
      </div>
    </div>
  `;

  return html;
}

calculateTotalClasses(timetable) {
  let total = 0;
  Object.values(timetable.days).forEach(classes => {
    total += classes.filter(cls => !cls.isBreak && !cls.isLunch && !cls.isFree).length;
  });
  return total;
}

calculateTotalHours(timetable) {
  let total = 0;
  Object.values(timetable.days).forEach(classes => {
    classes.forEach(cls => {
      if (!cls.isBreak && !cls.isLunch && !cls.isFree) {
        total += cls.duration || 1;
      }
    });
  });
  return total;
}

calculateUniqueCourses(timetable) {
  const courses = new Set();
  Object.values(timetable.days).forEach(classes => {
    classes.forEach(cls => {
      if (cls.code && !cls.isBreak && !cls.isLunch && !cls.isFree) {
        courses.add(cls.code);
      }
    });
  });
  return courses.size;
}

calculateLabSessions(timetable) {
  let labs = 0;
  Object.values(timetable.days).forEach(classes => {
    labs += classes.filter(cls => cls.type === 'Lab').length;
  });
  return labs;
}

// Add this method to the AdminDashboard class
async generateTimetableFromData(academicYear, semester, department) {
  // Get data from database
  const [coursesRes, facultyRes, roomsRes] = await Promise.all([
    databaseManager.getCourses(),
    databaseManager.getFaculty(),
    databaseManager.getRooms()
  ]);

  const courses = coursesRes.success ? coursesRes.data : [];
  const faculty = facultyRes.success ? facultyRes.data : [];
  const rooms = roomsRes.success ? roomsRes.data : [];

  // Filter courses for the selected department and semester
  const departmentCourses = courses.filter(course => 
    course.department === department && course.semester === semester
  );

  if (departmentCourses.length === 0) {
    throw new Error(`No courses found for ${department} Semester ${semester}`);
  }

  // Generate timetable structure
  const timetable = {
    academicYear,
    semester,
    department,
    days: {
      "Monday": this.generateDaySchedule(departmentCourses, faculty, rooms, "Monday"),
      "Tuesday": this.generateDaySchedule(departmentCourses, faculty, rooms, "Tuesday"),
      "Wednesday": this.generateDaySchedule(departmentCourses, faculty, rooms, "Wednesday"),
      "Thursday": this.generateDaySchedule(departmentCourses, faculty, rooms, "Thursday"),
      "Friday": this.generateDaySchedule(departmentCourses, faculty, rooms, "Friday")
    },
    generatedAt: new Date().toISOString()
  };

  return timetable;
}

// Add this method to generate schedule for a single day
generateDaySchedule(courses, faculty, rooms, day) {
  const schedule = [];
  const timeSlots = [
    { start: "8:30", end: "9:30" },
    { start: "9:30", end: "10:30" },
    { start: "10:30", end: "11:00", isBreak: true },
    { start: "11:00", end: "12:00" },
    { start: "12:00", end: "1:00", isLunch: true },
    { start: "1:00", end: "2:00" },
    { start: "2:00", end: "4:00" }
  ];

  // Filter available courses for this day (avoid scheduling same course multiple times per day)
  const availableCourses = [...courses];
  const scheduledCourses = new Set();

  timeSlots.forEach((slot, index) => {
    if (slot.isBreak) {
      schedule.push({
        time: `${slot.start}-${slot.end}`,
        course: "Break",
        type: "Break",
        isBreak: true
      });
      return;
    }

    if (slot.isLunch) {
      schedule.push({
        time: `${slot.start}-${slot.end}`,
        course: "Lunch",
        type: "Lunch",
        isLunch: true
      });
      return;
    }

    // Find an available course that hasn't been scheduled today
    const availableCourseIndex = availableCourses.findIndex(course => 
      !scheduledCourses.has(course.id)
    );

    if (availableCourseIndex !== -1 && availableCourses.length > 0) {
      const course = availableCourses[availableCourseIndex];
      
      // Find assigned faculty for this course
      const courseFaculty = faculty.find(f => 
        f.courses && f.courses.includes(course.id)
      ) || faculty[0]; // Fallback to first faculty if no assignment
      
      // Find suitable room
      const suitableRoom = rooms.find(room => 
        room.type === (course.type === 'lab' ? 'lab' : 'classroom') && 
        room.available
      ) || { name: 'Room 201' }; // Fallback room

      schedule.push({
        time: `${slot.start}-${slot.end}`,
        course: course.name,
        code: course.code,
        teacher: courseFaculty ? courseFaculty.name : 'Staff',
        room: suitableRoom.name,
        type: course.type === 'lab' ? 'Lab' : 'Theory',
        duration: slot.start === "2:00" ? 2 : 1 // 2-hour slot for afternoon labs
      });

      // Mark course as scheduled for today
      scheduledCourses.add(course.id);
      availableCourses.splice(availableCourseIndex, 1);
    } else {
      // Free period if no courses available
      schedule.push({
        time: `${slot.start}-${slot.end}`,
        course: "Free Period",
        type: "Free",
        isFree: true
      });
    }
  });

  return schedule;
}

// Add this method to the AdminDashboard class
renderTimetablePreview(timetable) {
  let html = `
    <div class="generated-timetable">
      <h4>üéâ Timetable Generated Successfully!</h4>
      <p>${timetable.department} - Semester ${timetable.semester} - Academic Year ${timetable.academicYear}</p>
      <div class="timetable-preview">
  `;
  
  Object.entries(timetable.days).forEach(([day, classes]) => {
    // Only show days that have classes scheduled
    const hasClasses = classes.some(cls => !cls.isBreak && !cls.isLunch && !cls.isFree);
    
    if (hasClasses) {
      html += `<div class="timetable-day">
        <h5>${day}</h5>
        <div class="day-classes">`;
      
      classes.forEach(cls => {
        if (cls.isBreak || cls.isLunch) {
          html += `<div class="timetable-slot break">
            <span class="time">${cls.time}</span>
            <span class="course">${cls.course}</span>
          </div>`;
        } else if (cls.isFree) {
          html += `<div class="timetable-slot free">
            <span class="time">${cls.time}</span>
            <span class="course">${cls.course}</span>
          </div>`;
        } else {
          html += `<div class="timetable-slot ${cls.type.toLowerCase()}">
            <span class="time">${cls.time}</span>
            <div class="class-details">
              <span class="course">${cls.course} ${cls.code ? `(${cls.code})` : ''}</span>
              <span class="teacher">${cls.teacher}</span>
              <span class="room">${cls.room}</span>
              ${cls.duration > 1 ? `<span class="duration">${cls.duration} hrs</span>` : ''}
            </div>
          </div>`;
        }
      });
      
      html += `</div></div>`;
    }
  });
  
  // Add timetable statistics
  const stats = this.calculateTimetableStats(timetable);
  html += `
    </div>
    <div class="timetable-stats">
      <div class="stat-item">
        <span class="stat-number">${stats.totalClasses}</span>
        <span class="stat-label">Total Classes</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">${stats.totalHours}</span>
        <span class="stat-label">Hours/Week</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">${stats.uniqueCourses}</span>
        <span class="stat-label">Courses</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">${stats.labSessions}</span>
        <span class="stat-label">Lab Sessions</span>
      </div>
    </div>
  </div>`;
  
  return html;
}

// Add this method to calculate timetable statistics
calculateTimetableStats(timetable) {
  let totalClasses = 0;
  let totalHours = 0;
  let uniqueCourses = new Set();
  let labSessions = 0;

  Object.values(timetable.days).forEach(classes => {
    classes.forEach(cls => {
      if (!cls.isBreak && !cls.isLunch && !cls.isFree) {
        totalClasses++;
        uniqueCourses.add(cls.course);
        
        // Calculate hours from time slot
        const [start, end] = cls.time.split('-');
        const startTime = this.parseTime(start);
        const endTime = this.parseTime(end);
        const duration = (endTime - startTime) / (1000 * 60 * 60); // Convert to hours
        totalHours += duration;
        
        if (cls.type === 'Lab') {
          labSessions++;
        }
      }
    });
  });

  return {
    totalClasses,
    totalHours: totalHours.toFixed(1),
    uniqueCourses: uniqueCourses.size,
    labSessions
  };
}

// Add this helper method to parse time strings
parseTime(timeStr) {
  const [time, modifier] = timeStr.split(/(am|pm)/i);
  let [hours, minutes] = time.split(':').map(Number);
  
  if (modifier?.toLowerCase() === 'pm' && hours < 12) hours += 12;
  if (modifier?.toLowerCase() === 'am' && hours === 12) hours = 0;
  
  const date = new Date();
  date.setHours(hours, minutes || 0, 0, 0);
  return date;
}
  }

  // Global functions
  function showSection(sectionId) {
    document.querySelectorAll('.content-section').forEach(section => {
      section.classList.remove('active');
    });
    document.getElementById(sectionId).classList.add('active');
    
    document.querySelectorAll('.menu-item').forEach(item => {
      item.classList.remove('active');
    });
    event.target.classList.add('active');
  }

  function showAddCourseModal() {
    adminDashboard.showModal('courseModal');
  }

  function showAddFacultyModal() {
    adminDashboard.showModal('facultyModal');
  }

  function showAddRoomModal() {
    adminDashboard.showModal('roomModal');
  }

  function hideModal(modalId) {
    adminDashboard.hideModal(modalId);
  }

  function searchCourses() {
    const query = document.getElementById('courseSearch').value;
    adminDashboard.searchCourses(query);
  }

  function searchFaculty() {
    const query = document.getElementById('facultySearch').value;
    adminDashboard.searchFaculty(query);
  }

  function searchRooms() {
    const query = document.getElementById('roomSearch').value;
    adminDashboard.searchRooms(query);
  }

  function importCourses() {
    adminDashboard.showNotification('Import courses functionality coming soon!', 'info');
  }

  function exportCourses() {
    adminDashboard.showNotification('Export courses functionality coming soon!', 'info');
  }

  function importFaculty() {
    adminDashboard.showNotification('Import faculty functionality coming soon!', 'info');
  }

  function exportFaculty() {
    adminDashboard.showNotification('Export faculty functionality coming soon!', 'info');
  }

  function importRooms() {
    adminDashboard.showNotification('Import rooms functionality coming soon!', 'info');
  }

  function exportRooms() {
    adminDashboard.showNotification('Export rooms functionality coming soon!', 'info');
  }

  function saveSettings() {
    adminDashboard.showNotification('Settings saved successfully!', 'success');
  }

  function resetSettings() {
    adminDashboard.showNotification('Settings reset to defaults!', 'info');
  }

  function nextStep(step) {
    document.querySelectorAll('.wizard-step').forEach(step => {
      step.classList.remove('active');
    });
    document.getElementById(`step${step}`).classList.add('active');
  }

  function prevStep(step) {
    document.querySelectorAll('.wizard-step').forEach(step => {
      step.classList.remove('active');
    });
    document.getElementById(`step${step}`).classList.add('active');
  }

  function generateTimetable() {
  adminDashboard.generateTimetable();
}

function exportTimetable() {
  adminDashboard.showNotification('üì• Timetable export functionality will be implemented!', 'info');
}

function saveTimetable() {
  adminDashboard.showNotification('üíæ Timetable saved to database!', 'success');
}

function publishTimetable() {
  adminDashboard.showNotification('üåê Timetable published! Students and faculty can now view it.', 'success');
}

function loadExistingData() {
  adminDashboard.showNotification('üì• Loading existing timetable data...', 'info');
  // You can implement actual data loading here
}

  // Initialize admin dashboard
  const adminDashboard = new AdminDashboard();

  // Export for global access
  window.adminDashboard = adminDashboard;
  window.showSection = showSection;
  window.showAddCourseModal = showAddCourseModal;
  window.showAddFacultyModal = showAddFacultyModal;
  window.showAddRoomModal = showAddRoomModal;
  window.hideModal = hideModal;
  window.searchCourses = searchCourses;
  window.searchFaculty = searchFaculty;
  window.searchRooms = searchRooms;
  window.nextStep = nextStep;
  window.prevStep = prevStep;
  window.generateTimetable = generateTimetable;
  window.exportTimetable = exportTimetable;
  window.saveTimetable = saveTimetable;
  window.publishTimetable = publishTimetable;
  window.loadExistingData = loadExistingData;
</script>
</body>
</html>